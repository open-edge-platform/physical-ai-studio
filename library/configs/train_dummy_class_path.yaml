# Example: Training config using jsonargparse class_path pattern
# This demonstrates the full power of dynamic class instantiation

seed_everything: 42

trainer:
  max_epochs: 100
  accelerator: auto
  devices: 1
  log_every_n_steps: 10
  gradient_clip_val: 1.0
  callbacks:
    - class_path: lightning.pytorch.callbacks.EarlyStopping
      init_args:
        patience: 10
        monitor: train/loss
        mode: min
    - class_path: lightning.pytorch.callbacks.ModelCheckpoint
      init_args:
        monitor: train/loss
        mode: min
        save_top_k: 3
        filename: "dummy-{epoch:02d}-{train/loss:.2f}"
    - class_path: lightning.pytorch.callbacks.LearningRateMonitor
      init_args:
        logging_interval: step

model:
  # Policy class with nested model and optimizer
  class_path: getiaction.policies.dummy.policy.Dummy
  init_args:
    model:
      class_path: getiaction.policies.dummy.model.Dummy
      init_args:
        action_shape: [7]  # 7-DOF robot arm
        n_action_steps: 4
        temporal_ensemble_coeff: 0.1
        n_obs_steps: 2
        horizon: 8
    optimizer:
      class_path: torch.optim.AdamW
      init_args:
        lr: 0.001
        weight_decay: 0.00001
        betas: [0.9, 0.999]
        eps: 1.0e-08

data:
  class_path: getiaction.data.lerobot.LeRobotDataModule
  init_args:
    repo_id: "lerobot/pusht"
    train_batch_size: 32
    # root: "/path/to/cache"  # Optional: custom cache dir
    # episodes: [0, 1, 2, 3, 4]  # Optional: specific episodes


